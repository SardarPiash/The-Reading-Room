<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Book details</title>
    <link rel="stylesheet" href="css/bookDetails.css" />
    <link rel="stylesheet" href="css/index.css" />
  </head>
  <body>
    <!-- Navbar -->
    <nav class="nav">
      <div>
        <div class="nav-container">
          <div class="icon-container">
            <div class="img-div">
              <img
                class="logo-img"
                src="assets/logo.png"
                alt="The Reading Room Logo"
              />
            </div>
            <div class="logo-text">reading room</div>
          </div>

          <div class="navigation-container">
            <button onclick="fetchAPI();  flag(true)" class="nav-button">
              <div class="navigation-element">
                <span>
                  <img
                    src="assets/home.png"
                    style="width: 20px; height: 20px"
                  />
                </span>
                <span style="margin-left: 2px; margin-top: 4px">Home</span>
              </div>
            </button>
            <button onclick="showWishlist();  flag(false)" class="nav-button">
              <div class="navigation-element" style="margin-left: 20px">
                <span>
                  <img
                    src="assets/wishlist.png"
                    style="width: 16px; height: 16px; margin-top: 4px"
                  />
                </span>
                <span style="margin-left: 2px; margin-top: 4px">Wishlist</span>
              </div>
            </button>
          </div>
        </div>
      </div>
    </nav>

    <div>
      <main id="book-details" style="display: flex; justify-content: center">
        <div class="loading-container">
          <span class="loading-text">Loading</span>
          <span class="dot dot1">.</span>
          <span class="dot dot2">.</span>
          <span class="dot dot3">.</span>
        </div>
      </main>
    </div>
  </body>
</html>

<script>
  //show bookdetails function
  const handleShowBookDteails = async (e) => {
    const bookdetails = document.getElementById("book-details");
    const response = await fetch(`https://gutendex.com//books?ids=${e}`);
    const datas = await response.json();
    const data = datas.results[0];
    console.log(datas);
    const bookImg =
      datas.results[0]?.formats["image/jpeg"] || "assets/fallback.png";
    console.log(bookImg);
    bookdetails.innerHTML = "";
    bookdetails.innerHTML = `
  <div class="details-container">
    <div><span class="detail-text">Book Details </span> </div>
     <div class="img-div-details"><img src="${bookImg}" style="width:200px; height:250px;"/></div>
     <div class="text-container" style="margin-top: 20px;">
            <div class="text-div">
              <span class="text">Book ID</span>
              </div>
          <div class="text-data">
            <span class="data">${data.id}</span>
          </div>
    </div>
    <div class="text-container">
            <div class="text-div">
              <span class="text">Book Name</span>
              </div>
          <div class="text-data">
            <span class="data">${data.title}</span>
          </div>
    </div>
    <div class="text-container">
            <div class="text-div">
              <span class="text">Author</span>
              </div>
          <div class="text-data">
            ${
              data.authors.length > 0
                ? `<span class="data">${data.authors[0]?.name} [${data.authors[0]?.birth_year}-${data.authors[0]?.death_year}]</span>`
                : "<span>Not Specified</span>"
            }
            </div>
    </div>

    <div class="text-container">
  <div class="text-div">
    <span class="text">Book shelves</span>
  </div>
  <div class="text-data">
    <span class="data">
      ${data.bookshelves
        .map((e) => `<span style="font-size: 15px;">${e}</span>`)
        .join(", ")}
    </span>
  </div>
</div>

<div class="text-container">
            <div class="text-div">
              <span class="text">Language</span>
              </div>
          <div class="text-data">
            <span class="data">${data.languages.map(
              (e) => `<span>${e} </span>`
            )}</span>
          </div>
    </div>

    <div class="text-container">
            <div class="text-div">
              <span class="text">Media type</span>
              </div>
          <div class="text-data">
            <span class="data">${data.media_type}</span>
          </div>
    </div>

    <div class="text-container">
            <div class="text-div">
              <span class="text">Translator</span>
              </div>
          <div class="text-data">
            ${
              data.translators.length > 0
                ? `<span class="data">${data.translators.map(
                    (e) => `<span>${e}</span>`
                  )}</span>`
                : "N/A"
            }
            </div>
    </div>

    <div class="text-container">
            <div class="text-div">
              <span class="text">Copy right</span>
              </div>
          <div class="text-data">
            <span class="data">${data.copyright === true ? "Yes" : "N/A"}</span>
          </div>
    </div>

    <div class="text-container">
            <div class="text-div">
              <span class="text">Total download</span>
              </div>
          <div class="text-data">
            <span class="data">${data.download_count}</span>
          </div>
    </div>


     <div class="text-container" style="height:auto;">
            <div class="text-div" style="height:auto; border-bottom:2px solid black;">
              <span class="text">Subjects</span>
              </div>
          <div class="text-data" style="height:auto;border-bottom:2px solid black;">
            <span class="data">${
              data.subjects.length > 0
                ? `<span>${data.subjects.map(
                    (e, index) =>
                      `${index === 0 ? "" : "</br>"}<span>${e}<span>`
                  )} </span>`
                : "N/A"
            }</span>
          </div>
    </div>
 
      </div>
  
  `;
  };

  // retrive bookid from url
  function getBookID() {
    const urlParam = new URLSearchParams(window.location.search);
    const bookId = urlParam.get("id");
    if (bookId) {
      handleShowBookDteails(bookId);
    }
  }
  getBookID();
</script>
